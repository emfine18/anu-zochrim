<script>
let anuVictims = [];

// Load CSV
Papa.parse(
  "https://raw.githubusercontent.com/yuval-harpaz/alarms/refs/heads/master/data/oct7database.csv",
  {
    download: true,
    header: true,
    complete: function (results) {
      anuVictims = results.data.filter(v => v.pid);
      console.log("Loaded records:", anuVictims.length);
    }
  }
);

function anuRunSearch() {
  const q = document.getElementById("anuSearchInput").value.trim().toLowerCase();
  if (!q) return;

  const matches = anuVictims.filter(v =>
    [
      v["שם פרטי"],
      v["שם משפחה"],
      v["שם נוסף"],
      v["כינוי"],
      v["Residence"],
      v["מקום האירוע"],
      v["Role"]
    ].some(field =>
      field && field.toString().toLowerCase().includes(q)
    )
  );

  anuRenderResults(matches);
}
</script>
